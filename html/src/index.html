<!DOCTYPE html>
<html lang="es">
  <head>
    <!-- contiene la meta información de la página-->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulario de usuario</title>
  </head>

  <body>
    <h1>Crear usuario 2313</h1>
    <!-- pagina web con un formulario con 3 propiedades name , lastname  y age-->
    <form class="form" id="form">
      <label for="name">Nombre</label>
      <input type="text" name="name" id="name" />
      <br />
      <label for="lastname">Apellido</label>
      <input type="text" name="lastname" id="lastname" />
      <br />
      <label for="age">Edad</label>
      <input type="number" name="age" id="age" />
      <br />
      <input type="submit" value="Enviar" />
    </form>

    <form></form>

    <script>
      // constante llamada form que contine el formulario
      const form = document.querySelector("#form");
      function submitForm(e) {
        e.preventDefault(); // esto para la propagacion del evento

        var name = document.querySelector("#name").value;
        var lastname = document.querySelector("#lastname").value;
        var age = document.querySelector("#age").value;
        //crear un objeto con los datos
        var user = {
          name: name,
          lastname: lastname,
          age: age,
        };

        fetch("http://api.bodamiriamyandres.com/user", {
          headers: {
            "Content-Type": "application/json",
          },
          method: "POST",
          body: JSON.stringify(user),
        })
          .then(function (response) {
            if (response.ok) {
              return response.json();
            } else {
              throw "Error en la llamada Ajax";
            }
          })
          .then(function (userResponse) {
            alert(JSON.stringify(userResponse));
          })
          .catch(function (err) {
            alert(err);
          });
      }

      form.addEventListener("submit", submitForm);
    </script>
  </body>
</html>
